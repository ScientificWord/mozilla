\makeatletter
\def\includegraphics{%
   \@ifnextchar[{\msi@includegraphicsA}{\msi@includegraphicsB}}

\def\msi@includegraphicsA[#1]#2{%
  \msi@includegraphicsB{#2}}

\def\msi@includegraphicsB#1{%
   \msitag{<object src="}%
       \msigraphicname{#1}%
   \msitag{"/>}}

\def\graphicspath#1{%
  \msitopreambleextra{^^0a\graphicspath{#1}}%
  \begingroup\msi@inpreamble=0
    \msi@graphicspath{.}%
    \msi@collectpath#1!%
  \endgroup}

\def\msi@collectpath#1{%
   \def\tmp{#1}
   \def\excl{!}
   \ifx\tmp\excl
      \let\@next\relax
   \else
      \expandafter\msi@graphicspath\expandafter{\the\msi@graphicspath;#1}
      \let\@next\msi@collectpath
   \fi
   \@next
}



\makeatother
