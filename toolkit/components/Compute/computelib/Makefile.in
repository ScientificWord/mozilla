# Copyright (c) 2006 MacKichan Software, Inc.  All Rights Reserved.

DEPTH		= ../../../..
topsrcdir	= @top_srcdir@
srcdir		= @srcdir@
VPATH		= @srcdir@

include $(DEPTH)/config/autoconf.mk

MODULE = compute
MODULE_NAME = computeModule
LIBRARY_NAME = computelib_s
IS_COMPONENT = 1
EXPORT_LIBRARY = 1
LIBXUL_LIBRARY = 1
GRE_MODULE	= 1

MOZILLA_INTERNAL_API = 1
FORCE_STATIC_LIB = 1

MOZILLA_INTERNAL_API = 1

include $(topsrcdir)/config/config.mk

CPPSRCS =				\
  DefStore.cpp  \
  SNode.cpp \
  MRequest.cpp \
  MResult.cpp \
  PrefStor.cpp  \
  $(NULL)

REQUIRES = \
  string \
  xpcom \
  compute \
  $(NULL)


LOCAL_INCLUDES = -I$(srcdir)/../libtci	\
	         -I$(srcdir)/../Engines	\
                 -I$(srcdir)/../src \
		 -I$(srcdir)/../public \
	         $(NULL)

SupportFiles	:= \
			$(srcdir)/swfcns.mu \
			$(NULL)

#ifeq ($(OS_ARCH),WINNT)
MuPADlib	:= \
			$(srcdir)/../MuPAD/lib/lib.tar \
			$(srcdir)/../MuPAD/lib/lib.toc \
			$(srcdir)/../MuPAD/lib/sysinit.mu \
			$(wildcard $(srcdir)/../MuPAD/lib/xmlprint.*) \
			$(NULL)


ifeq ($(OS_ARCH),WINNT)
MuPADlicense	:= \
			$(srcdir)/../MuPAD/license/license \
			$(NULL)
SupportFiles	+= \
			$(srcdir)/../MuPAD/win32/mupkernel.dll \
			$(srcdir)/tcifcns.m \
			$(NULL)
endif
ifeq ($(OS_ARCH),Darwin)
MuPADlicense	:= \
			$(srcdir)/../MuPAD/Darwin/com.sciface.www.MuPADPro402.plist \
			$(NULL)
MuPADMacbin	:= $(wildcard $(srcdir)/../MuPAD/Darwin/bin/*) 
MuPADMaclib	:= $(wildcard $(srcdir)/../MuPAD/Darwin/lib/*) 
MuPADMacmod	:= $(wildcard $(srcdir)/../MuPAD/Darwin/modules/*) 
MuPADFrameworks := $(wildcard $(srcdir)/../MuPAD/Darwin/Frameworks/*)

endif
ifeq ($(OS_ARCH),Linux)
MuPADlicense	:= \
			$(srcdir)/../MuPAD/license/license \
			$(NULL)
MuPADlinuxbin	:= $(wildcard $(srcdir)/../MuPAD/linux/bin/*) 
MuPADlinuxlib	:= $(wildcard $(srcdir)/../MuPAD/linux/lib/*) 
MuPADlinuxmod	:= $(wildcard $(srcdir)/../MuPAD/linux/modules/*) 

endif



include $(topsrcdir)/config/rules.mk

ifeq ($(OS_ARCH),WINNT)
export:: $(MuPADlib)
	$(INSTALL) $(MuPADlib) $(FINAL_TARGET)/MuPAD/lib

export:: $(SupportFiles) 
	$(INSTALL) $(SupportFiles) $(FINAL_TARGET)
endif
ifeq ($(OS_ARCH),Darwin)
export:: $(MuPADlib)
	$(INSTALL) $(MuPADlib) $(FINAL_TARGET)/MuPAD/lib
	$(INSTALL) $(MuPADlicense) $(FINAL_TARGET)/MuPAD/license
	$(INSTALL) $(SupportFiles) $(FINAL_TARGET)
	$(INSTALL) $(MuPADMacbin) $(FINAL_TARGET)/MuPAD/Mac/bin
	$(INSTALL) $(MuPADMaclib) $(FINAL_TARGET)/MuPAD/Mac/lib
	$(INSTALL) $(MuPADMacmod) $(FINAL_TARGET)/MuPAD/Mac/modules
	$(INSTALL) $(MuPADFrameworks) $(FINAL_TARGET)/MuPAD/Frameworks

else
export:: $(MuPADlib)
	$(INSTALL) $(MuPADlib) $(FINAL_TARGET)/MuPAD/lib
	$(INSTALL) $(MuPADlicense) $(FINAL_TARGET)/MuPAD/license
	$(INSTALL) $(SupportFiles) $(FINAL_TARGET)
	$(INSTALL) $(MuPADlinuxbin) $(FINAL_TARGET)/MuPAD/linux/bin
	$(INSTALL) $(MuPADlinuxlib) $(FINAL_TARGET)/MuPAD/linux/lib
	$(INSTALL) $(MuPADlinuxmod) $(FINAL_TARGET)/MuPAD/linux/modules
endif

