% sw20ndsu.sty   For NDSU disquisitions.
% Copied from sw20tuls.sty (by JCP) and renovated.
%\tracingmacros=1    %  For debugging
\typeout{SW Document Style `sw20ndsu' <25 Nov. 2002>.}
\typeout{NOTICE:  This macro file is NOT proprietary and may be 
freely copied and distributed.}
\input tcilcomm.tex
\input ulem.sty
% New changes are marked "NDSU".
%
\input thmsupp.tex %TCI theorem option support
%
\@twosidefalse
%
% These lines should override those in ``book.cls".  
\renewcommand\thechapter       {\arabic{chapter}.}
\renewcommand\thesection       {\arabic{chapter}.\arabic{section}}
\renewcommand\thesubsection    {\thesection.\arabic{subsection}}
\renewcommand\thesubsubsection {\thesubsection .\alph{subsubsection}}
\renewcommand\theparagraph     {\thesubsubsection.\arabic{paragraph}} 
\renewcommand\thesubparagraph  {\theparagraph.\arabic{subparagraph}}
% Add for appendices in FAF
\newcounter{appendixflag}   
%
\setlength{\oddsidemargin}{.375in}
\setlength{\evensidemargin}{.375in}
\setlength{\textwidth}{6.125in}
\setlength{\topmargin}{-0.45in}   % Top of page no. is 0.45in up
\setlength{\headheight}{0.20in} % Page no. takes up .20in of vertical space.
\setlength{\headsep}{0.25in}   % Top of text is 0.25in under page no.
%\setlength{\topmargin}{-30pt}
\setlength{\textheight}{9.0in}
\setlength{\leftmargin}{0in}
\setlength{\parindent}{3em}
\setlength{\baselineskip}{0.2in}
%\def\baselinestretch{2}       
% Try this for base pagenumber positions
%\setlength{\footheight}{0.15in} 
\setlength{\footskip}{0.25in}

\def\listfigurename{LIST OF FIGURES}
\def\listtablename{LIST OF TABLES}

\def\singlespace{\def\baselinestretch{1}\large\normalsize}
\def\doublespace{\def\baselinestretch{2}\large\normalsize}

\newfield{thesistitle}{Title:}
\newfield{abstitle}{Title for Abstract:}
\newfield{thesisauthor}{Author:}
\newfield{degreename}{Degree:}
\newfield{disquisition}{Disquisition:}
\newfield{datemy}{Month,Year:}
%\newfield{absauthor}{Author and Degree:}
\newfield{department}{Major Department:}
\newfield{totalpages}{Total Pages:}
\newfield{totalchapters}{Final Chapter Number:}
\newfield{absinfo}{Name (LFM), Degree, Dept, Coll,:}
\newfield{directedby}{Directed by:}
\newfield{numwords}{Number of Words in Abstract:}
%
\newfield{thelistoffigures}{The List of Figures}
\newfield{thelistoftables}{The List of Tables}
\newfield{thetableofcontents}{The Table of Contents}
%\newfield{nomenclature}{Nomenclature}
\newfield{preface}{Preface}
\newfield{toc}{Table of Contents: }
\newfield{lof}{List of Figures: }
\newfield{lot}{List of Tables: }

\def\@do@thesistitle{}
\def\@do@abstitle{}
\def\@do@thesisauthor{}
\def\@do@degreename{}
\def\@do@disquisition{}
\def\@do@datemy{}
% Abstract lines for FAF.
\def\@do@department{}
%\def\@do@absauthor{}
\def\@do@totalpages{}
\def\@do@totalchapters{}
\def\@do@absinfo{}
\def\@do@directedby{}
\def\@do@numwords{}
% 2002/11/25 (gp) Define additional fields to replace hard coded strings
\newfield{university}{University:}
\def\@do@university{}
\def\the@university{North Dakota State University}
\newfield{universitydept}{Department: }
\def\@do@universitydept{}
\def\the@universitydept{Agriculture and Applied Science}
\newfield{universitycity}{City: }
\def\@do@universitycity{}
\def\the@universitycity{Fargo, North Dakota}

% Try setting list parameters here.  NDSU
\setlength{\labelwidth}{0.375in}
\setlength{\labelsep}{0.125in}

\def\titlepp{%
    \pagenumbering{roman}
	\thispagestyle{empty}
	   \setcounter{appendixflag}{0}   % Arbitrary placement.  
\null
\vspace*{-0.5in}
	\doublespace
%   \addcontentsline{toc}{chapter}{TITLE PAGE}
%\def\baselinestretch{2}\large\normalsize
%\setlength{\topmargin}{1in}  %  Need 2 inches from top!
    \begin{center} 
         {\expandafter\uppercase\expandafter{\bf \the@thesistitle}} \\
	\vskip 1.0in
	\singlespace
	A {\the@disquisition} \\
	Submitted to the Graduate Faculty \\
	of the \\
	\the@university \\
	of \the@universitydept \\
    \vskip 1.2in 
	\doublespace
        by\\
        {\the@thesisauthor} \\
    \vskip 1.2in 
	\singlespace
	In Partial Fulfillment of the Requirements \\
	for the Degree of \\
	{\the@degreename} \\
    \vskip 0.6in 
	Major Department: \\
	{\the@department} \\
    \vskip 0.6in 
    {\the@datemy} \\
	\vfill
      \the@universitycity \\
     \end{center}
}

\def\approvalpage{%
%\null\vfil
	\newpage
	\pagestyle{empty}
	\null
	\vspace*{-0.5in}
%\def\baselinestretch{2}\large\normalsize
	\doublespace
%\setlength{\topmargin}{1in}  %  Need 2 inches from top!
    \begin{center}
		 APPROVAL PAGE HERE \\
%	 GRADUATE SCHOOL \\
		 \vskip 1.0in     % 7 spaces
		 (OBTAIN AT THE GRADUATE SCHOOL) \\
		\vskip 0.5in
         {\expandafter\uppercase\expandafter{\the@thesistitle}} \\
%   \def\baselinestretch{1}\large\normalsize \\
	\singlespace
        by \\
        {\the@thesisauthor} \\
	\doublespace
		A THESIS \\
  \vskip 1.2in 
	By Thesis Committee \\
	\end{center}
\begin{flushleft}
\hspace*{1.5in}\makebox[3in]\hrulefill , Chairperson \newline
\hspace*{1.5in}\makebox[3in]\hrulefill \newline
\hspace*{1.5in}\makebox[3in]\hrulefill \newline
\end{flushleft}
\vfil\vfil
\addtocounter{page}{-1}
}

\def\dedication{%
      \newpage
      \pagestyle{empty}
	  \null
	  \vspace*{-0.5in}
      \begin{center} 
         {\bf DEDICATION}
      \end{center}
	  \addcontentsline{toc}{chapter}{DEDICATION}
	  \vskip 0.2in
	  \doublespace
}

\def\generalabstract{%
      \newpage
      \pagestyle{empty}
	  \null
	  \vspace*{-0.5in}
      \begin{center} 
         {\bf ABSTRACT}
      \end{center}
	  \addcontentsline{toc}{chapter}{ABSTRACT}
      \vskip 0.2in   % 3 spaces 
	  \singlespace
	  \the@absinfo \the@datemy \the@abstitle Major Professor: \the@directedby 
	  \\
	  \vskip 0.0in
	  \doublespace
}

\def\@do@thelistoffigures{%
       \newpage\null
	   \vspace*{-0.5in}
       \begin{center} {\bf LIST OF FIGURES} \end{center} %
	   \singlespace
\begin{flushleft} \underline{Figure} \hfill \underline{Page} %
\end{flushleft} 
\vskip -0.2in
%   \vskip 24pt
       \@starttoc{lof}
	   \addcontentsline{toc}{chapter}{LIST OF FIGURES}
	   \doublespace
}
%
\def\@do@thelistoftables{%
       \newpage\null
	   \vspace*{-0.5in}
       \begin{center} {\bf LIST OF TABLES} \end{center} %
	   \singlespace
\begin{flushleft} \underline{Table} \hfill \underline{Page}  %
\end{flushleft} 
\vskip -0.2in
%   \vskip 24pt
       \@starttoc{lot}%
       \addcontentsline{toc}{chapter}{LIST OF TABLES}  
	   \doublespace
}
%
\def\@do@nomenclature{%
% Set table parameters so that a table can be used after newpage.
%   I still need to find examples - how is the default table4_3 defined?
%\setlength{\tabcolsep}{0.5in}
       \newpage\null \thispagestyle{plain}
       \begin{center} {\bf NOMENCLATURE} \end{center}
	   \singlespace
\begin{flushleft}
\underline{Variable}\hspace{1.2in} \underline{Definition} \\
\end{flushleft}
       \addcontentsline{toc}{chapter}{NOMENCLATURE}  
	   \doublespace
	   \vskip -0.2in
}
% nomenclature above
%                 

\def\acknowledgments{%
      \newpage
      \thispagestyle{plain}
	  \null
	  \vspace*{-0.5in}
      \begin{center} {\bf ACKNOWLEDGMENTS} \end{center}%
	  \addcontentsline{toc}{chapter}{ACKNOWLEDGMENTS}
%     \vskip 24pt
}
\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{1}
%
\def\@do@thetableofcontents{%
      \newpage\null
	  \vspace*{-0.5in}
	  \begin{center} {\bf TABLE OF CONTENTS} \end{center}
	  \singlespace
%  \vskip 24pt
%\vskip -0.2in
      \@starttoc{toc}
% Remove this line - it screws up the toc and is unnecessary.  JP
  %   \addtocontents{toc}{\protect{\singlespace}}%
%  \addcontentsline{toc}{chapter}{TABLE OF CONTENTS}
	  \doublespace
}
%
% 
\let\para\par

\def\firstchapter{%
       \pagestyle{plain}
       \pagenumbering{arabic}
%      \addtocontents{toc}{\protect{\addvspace{12pt}}} 	   % Rem for FAF
%   \addtocontents{toc}{\protect{\noindent{Chapter}\para}}	   % Rem for FAF
       \def\firstchapter{\relax}}
%
\def\@makechapterhead#1{%
      \null
	  \vspace*{-0.5in}
      \begin{center} 
	  {\ifnum\theappendixflag = 1
		{\bf APPENDIX \thechapter} \\
		\else
        {\bf CHAPTER \thechapter} \\
		\fi }
%        CHAPTER \thechapter\\         % Try \bf for FAF
%      {\bf #1 }      % Try to get the chapter name in bf...
%      {\expandafter\uppercase\expandafter{\bf #1}} \\
       {\uppercase{\bf #1}} \\
	  \end{center}
      \nobreak
}


\def\l@chapter#1#2{%
   \addpenalty{-\@highpenalty}%
   \vskip 1.0em plus\p@
%  \@tempdima 1.5em
   \@tempdima 1.25in   % for FAF
   \begingroup
     \parindent \z@ \rightskip \@pnumwidth
     \parfillskip -\@pnumwidth
%    \bf
     \leavevmode
     \advance\leftskip\@tempdima
     \hskip -\leftskip
%\hspace*{1.25in}    % for FAF
%    #1\nobreak\dotfill \nobreak\hbox to\@pnumwidth{\hss #2}\par
    {\uppercase {#1}}\nobreak\dotfill \nobreak\hbox to\@pnumwidth{\hss #2}\par
     \penalty\@highpenalty
   \endgroup}


\def\@chapter[#1]#2{%
        \newpage\thispagestyle{plain}
        \firstchapter
        \ifnum \c@secnumdepth >\m@ne
           \refstepcounter{chapter}%
           \typeout{\@chapapp\space\thechapter}%
            % Add if statement below for FAF
           \addcontentsline{toc}{chapter}
            {\ifnum\theappendixflag = 1 
            {\protect\numberline{APPENDIX \thechapter}#1} 
			\else
            {\protect\numberline{CHAPTER \thechapter}#1} 
			\fi }
                    % add CHAPTER above for FAF
%	   \addtocontents{toc}{\protect{\addvspace{12pt}}}	
        \else
           \addcontentsline{toc}{chapter.}{#1}
        \fi
        \chaptermark{#1}%
        \addtocontents{lof}%
%            {\protect\addvspace{10\p@}}% Adds between-chapter space
             {\protect\addvspace{0\p@}}% Adds between-chapter space
        \addtocontents{lot}%
%            {\protect\addvspace{10\p@}}% to lists of figs & tables.
             {\protect\addvspace{0\p@}}% to lists of figs & tables.
        \@makechapterhead{#2}%
        \@afterheading
}


%
% Here we define a new version of \@startsection which is just like the 
% original but uses a new version of \@sect (defined next).  A section 
% defined with this macro will have its heading underlined.
%     
\def\@ULstartsection#1#2#3#4#5#6{%
   \if@noskipsec \leavevmode \fi
   \par \@tempskipa #4\relax
   \@afterindenttrue
   \ifdim \@tempskipa <\z@ \@tempskipa -\@tempskipa \@afterindentfalse\fi
   \if@nobreak \everypar{}\else
     \addpenalty{\@secpenalty}\addvspace{\@tempskipa}\fi \@ifstar
     {\@ULssect{#3}{#4}{#5}{#6}}{\@dblarg{\@ULsect{#1}{#2}{#3}{#4}{#5}{#6}}}}
%
\def\@ULsect#1#2#3#4#5#6[#7]#8{%
       \ifnum #2>\c@secnumdepth
           \let\@svsec\@empty
       \else
           \refstepcounter{#1}

           \edef\@svsec{\csname the#1\endcsname\hskip 1em}
       \fi
       \@tempskipa #5\relax
       \ifdim \@tempskipa>\z@
         \begingroup
             #6\relax 
             \@hangfrom{\hskip #3\relax\uline{\@svsec}}%
             {\interlinepenalty \@M\uline{#8}\par}%
         \endgroup
         \csname #1mark\endcsname{#7}
		 % Add below to fix TOC? FAF
    \addtocontents{toc}{\protect{\addvspace{12pt}}} 
         \addcontentsline{toc}{#1}
             {\ifnum #2>\c@secnumdepth 
              \else
                \hspace{.25in}\protect\numberline{\csname the#1\endcsname}%
              \fi #7}
      \else

         \def\@svsechd{\hskip #3\relax  %% \relax added 2 May 90
                  \uline{\@svsec}\uline{#8}\csname #1mark\endcsname{#7}
   % \addtocontents{toc}{\protect{\addvspace{12pt}}} 
                 \addcontentsline
                   {toc}{#1}
                   {\ifnum #2>\c@secnumdepth \else
                   \protect\numberline{\csname the#1\endcsname}%
                   \fi#7}}
      \fi
      \@xsect{#5}}
%   
\def\@ULssect#1#2#3#4#5{\@tempskipa #3\relax
   \ifdim \@tempskipa>\z@
     \begingroup #4\@hangfrom{\hskip #1}{\interlinepenalty \@M \uline{#5}\par}\endgroup
   \else \def\@svsechd{#4\hskip #1\relax \uline{#5}}\fi
    \@xsect{#3}}
%
\def\section{\@ULstartsection {section}{1}{\z@}{12pt plus .1ex minus
    .1ex}{12pt plus.2ex}{\reset@font\normalsize}}
%\def\section{\@ULstartsection {section}{1}{\z@}{12pt plus .1ex minus
%   .1ex}{12pt plus.2ex}{\reset@font\normalsize}}
\def\subsection{\@ULstartsection{subsection}{2}{\z@}{12pt plus .1ex
    minus .2ex}{0pt plus.1ex}{\reset@font\normalsize}}
% \def\subsection{\@ULstartsection{subsection}{2}{\z@}{12pt plus .1ex
%   minus .2ex}{6pt plus.1ex}{\reset@font\normalsize}}
\def\subsubsection{\@ULstartsection{subsubsection}{3}{\z@}
{12pt plus .1ex minus-.2ex}{0pt plus .1ex}{\reset@font\normalsize}}
%\def\subsubsection{\@ULstartsection{subsubsection}{3}{\z@}
%{12pt plus .1ex minus-.2ex}{5pt plus .1ex}{\reset@font\normalsize}}
% -1ex minus-.2ex}{-1.5ex plus-.2ex}{\reset@font\normalsize}} % Replace w/next - JP

% The next two should not be used in this style.
\def\paragraph{\@startsection
     {paragraph}{4}{\z@}{3.25ex plus 1ex minus.2ex}{-1em}{\reset@font
     \normalsize}}
\def\subparagraph{\@startsection
%    {subparagraph}{5}{\parindent}{3.25ex plus1ex minus
%    .2ex}{-1em}{\reset@font\normalsize}} 
     {subparagraph}{5}{\parindent}{3.25ex plus 1ex minus .2ex}
     {3em}{\reset@font\normalsize}} 

       
\def\appendix{%
%  The appendix sections will be started with the chapter pop-up option.
%\newpage
%\null
	   \vspace*{-0.5in}
%\begin{center}
%{\bf APPENDIX \Alph . \thechapter }
%\end{center}
	\setcounter{chapter}{0}
	\setcounter{appendixflag}{1}
\renewcommand\thechapter       {\Alph{chapter}.}
%   \addtocontents{toc}{\protect{\addvspace{12pt}}} 
%   \addtocontents{toc}{\protect{\noindent{Appendices}\para}}
 	   	     % Previous sections were not numbered - start now.
	   \setcounter{section}{0}
	   \setcounter{subsection}{0}
	   \setcounter{subsubsection}{0}
%   \def\thesection{\Alph{section}.}
       \def\theequation{\thesection\arabic{equation}}
}
% Take from "book.cls" and adapt.  FAF
\newdimen\bibindent
\bibindent=0pt
\def\bibname{\vspace*{-1.2in} \normalsize\bf \begin{center}REFERENCES CITED\end{center}}
\def\@biblabel#1{#1.}
\renewenvironment{thebibliography}[1]
     {\chapter*{\bibname
        \@mkboth{\MakeUppercase\bibname}{\MakeUppercase\bibname}}%
      \list{\@biblabel{\@arabic\c@enumiv}}%
           {\settowidth\labelwidth{\@biblabel{#1}}%
            \leftmargin\labelwidth
            \advance\leftmargin\labelsep
            \@openbib@code
            \usecounter{enumiv}%
            \let\p@enumiv\@empty
            \renewcommand\theenumiv{\@arabic\c@enumiv}}%
%  Try to stick the toc entry here.
	    \addcontentsline{toc}{chapter}{REFERENCES CITED}
      \sloppy
      \clubpenalty4000
      \@clubpenalty \clubpenalty
      \widowpenalty4000%
      \sfcode`\.\@m}
     {\def\@noitemerr
       {\@latex@warning{Empty `thebibliography' environment}}%
      \endlist}
%\newcommand\newblock{\hskip .11em\@plus.33em\@minus.07em}
\let\@openbib@code\@empty
% Superscript citations -- skip optional arg to \cite   % From AIP.sty
% Move citation after period and comma.
\def\@cite#1#2{\unskip\nobreak\relax
    \def\@tempa{$\m@th^{\hbox{\the\scriptfont0 #1}}$}%
    \futurelet\@tempc\@citexx}
\def\@citexx{\ifx.\@tempc\let\@tempd=\@citepunct\else
    \ifx,\@tempc\let\@tempd=\@citepunct\else
    \let\@tempd=\@tempa\fi\fi\@tempd}
\def\@citepunct{\@tempc\edef\@sf{\spacefactor=\the\spacefactor\relax}\@tempa
    \@sf\@gobble}


\def\quote{\list{}{\rightmargin\leftmargin}\item[]
\def\baselinestretch{1}\large\normalsize}
\def\endquote{%
       \endlist
       \def\baselinestretch{2}\large\normalsize}

%
%\parindent 20pt
\parindent 3em

\long\def\@footnotetext#1{%
       \insert\footins{%
          \reset@font
          \footnotesize
          \interlinepenalty\interfootnotelinepenalty
          \splittopskip
          \footnotesep
          \splitmaxdepth \dp\strutbox 
          \floatingpenalty \@MM
          \hsize\columnwidth 
          \@parboxrestore
          \edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}
          \@makefntext{%
           \rule{\z@}{\footnotesep}\ignorespaces
           \baselineskip 12pt #1\@finalstrut\strutbox}%
        }%
}


% No feet
\def\@oddfoot{}
\def\@evenfoot{}

% Copy and adjust the myheadings definition from "book.cls" for FAF.
\def\ps@myheadings{%
    \let\@oddfoot\@empty\let\@evenfoot\@empty
%   \def\@evenhead{\thepage\hfil\slshape\leftmark}%
%   \def\@oddhead{{\slshape\rightmark}\hfil\thepage}%
\def\@evenhead{\rm \makebox[6.25in][r]{ \thepage}}% Left heading.
\def\@oddhead{\rm \makebox[6.25in][r]{ \thepage}}%   Right heading.
    \let\@mkboth\@gobbletwo
    \let\chaptermark\@gobble
    \let\sectionmark\@gobble
    }

% Copied the below from "book.cls".  Perhaps changing these caption
% parameters will adjust the listoftables entries.
% \newcounter{table}[chapter]
\renewcommand\thetable{\thechapter.\@arabic\c@table}
\def\fps@table{htbp}
\def\ftype@table{2}
\def\ext@table{lot}
\def\fnum@table{\tablename~\thetable}
% \newenvironment{table}
               % {\@float{table}}
               % {\end@float}
% \newenvironment{table*}
               % {\@dblfloat{table}}
               % {\end@dblfloat}
% \newlength\abovecaptionskip
% \newlength\belowcaptionskip
\setlength\abovecaptionskip{10\p@}   % Original value 10\p@
\setlength\belowcaptionskip{0\p@}    % Original value 0\p@
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{#1: #2}%
  \ifdim \wd\@tempboxa >\hsize
    #1: #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}