# Copyright (c) 2006 MacKichan Software, Inc.  All Rights Reserved.

DEPTH		= ../../..
topsrcdir	= @top_srcdir@
srcdir		= @srcdir@
VPATH		= @srcdir@

include $(DEPTH)/config/autoconf.mk

MODULE		   = wrappers
LIBRARY_NAME   = wrappers
#IS_COMPONENT   = 1
FORCE_SHARED_LIB = 1


REQUIRES = \
	compute \
	string \
	xpcom \
	editor \
	$(NULL)

CPPSRCS = \
	msiMuPADEngineWrapper.cpp \
	$(NULL) 


include $(topsrcdir)/config/config.mk

EXPORTS = \
  msiMuPADEngineWrapper.h \
  $(NULL)

QT_LIB := $(LIBXUL_DIST)/lib/libQtCore.4.dylib


# separate libraries linked in.
SHARED_LIBRARY_LIBS += \
	$(DIST)/../../xulrunner/toolkit/components/Compute/computelib/$(LIB_PREFIX)computelib_s.$(LIB_SUFFIX) \
	$(DIST)/../../xulrunner/toolkit/components/Compute/Engines/$(LIB_PREFIX)enginelib_s.$(LIB_SUFFIX) \
	$(DIST)/../../xulrunner/toolkit/components/Compute/libtci/$(LIB_PREFIX)libtci_s.$(LIB_SUFFIX) \
	$(DIST)/../../xulrunner/toolkit/components/Compute/Engines/MuPAD/$(LIB_PREFIX)mupwrapperlib_s.$(LIB_SUFFIX) \
	$(DIST)/../../xulrunner/xpcom/string/src/$(LIB_PREFIX)string_s.$(LIB_SUFFIX) \
	$(NULL)

ifeq ($(OS_ARCH),WINNT)
SHARED_LIBRARY_LIBS += \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/win32/$(LIB_PREFIX)mupcomkernel.$(LIB_SUFFIX) \
	$(NULL)
endif

ifeq ($(OS_ARCH),Linux)
SHARED_LIBRARY_LIBS += \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/linux/$(LIB_PREFIX)mupudskernel.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/linux/$(LIB_PREFIX)libstream.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/linux/$(LIB_PREFIX)mut.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/linux/$(LIB_PREFIX)xmlparser.$(LIB_SUFFIX) \
	$(NULL)
endif

ifeq ($(OS_ARCH),Darwin)
SHARED_LIBRARY_LIBS += \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/maci/$(LIB_PREFIX)mupudskernel.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/maci/$(LIB_PREFIX)libstream.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/maci/$(LIB_PREFIX)mut.$(LIB_SUFFIX) \
	$(topsrcdir)/toolkit/components/Compute/MuPAD/maci/$(LIB_PREFIX)xmlparser.$(LIB_SUFFIX) \
	$(NULL)

endif

include $(topsrcdir)/config/rules.mk
LOCAL_INCLUDES =	-I$(topsrcdir)/toolkit/components/Compute/Engines \
	-I$(topsrcdir)/toolkit/components/Compute/Engines/MuPAD \
	-I$(topsrcdir)/toolkit/components/Compute/public \
	-I$(topsrcdir)/toolkit/components/Compute/computelib \
	-I$(topsrcdir)/toolkit/components/Compute/libtci \
	-I$(topsrcdir)/toolkit/components/Compute/Engines/MuPAD \
  $(NULL)


EXTRA_DSO_LDOPTS += \
	$(MOZ_COMPONENT_LIBS) \
	$(MOZ_UNICHARUTIL_LIBS) \
	$(NULL)

ifeq ($(OS_ARCH),Darwin)
EXTRA_DSO_LDOPTS += \
	-lQtCore.4 -lz -lexpat -lxpcomglue_s \
	$(NULL)
endif


ifeq ($(OS_ARCH),Linux)
EXTRA_DSO_LDOPTS += \
	-lQtCore -lz -lexpat -lxpcomglue_s \
	$(NULL)
endif

ifeq ($(OS_ARCH),WINNT)
EXTRA_DSO_LDOPTS += \
  $(DIST)/../../xulrunner/dist/lib/$(LIB_PREFIX)xpcomglue_s.$(LIB_SUFFIX) \
	$(NULL)
endif

DEFINES += -DMOZ_DLL_PREFIX=\"$(DLL_PREFIX)\"

ifeq ($(OS_ARCH),Darwin)
export:: $(QT_LIB)
	$(INSTALL)  $(QT_LIB) $(FINAL_TARGET)

endif
                 
dump::
	echo MOZ_COMPONENT_LIBS
	echo $(MOZ_COMPONENT_LIBS)
	echo DIST
	echo $(DIST)
	echo LIBXUL_DIST
	echo $(LIBXUL_DIST)
	echo EXTRA_DSO_LDOPTS
	echo $(EXTRA_DSO_LDOPTS)
	echo DSO_LDOPTS
	echo $(DSO_LDOPTS)
	echo srcdir
	echo $(srcdir)
	echo XPCOM_FROZEN_LDOPTS
	echo $(XPCOM_FROZEN_LDOPTS)
	echo XPCOM_LDOPTS
	echo $(XPCOM_LDOPTS)
	echo NSPR_LIBS
	echo $(NSPR_LIBS)

